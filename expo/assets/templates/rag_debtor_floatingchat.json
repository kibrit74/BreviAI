{
    "id": "rag-debtor-tracking-v3",
    "name": "ğŸ§  BorÃ§lu Takip Sistemi",
    "description": "DoÄŸal dil ile borÃ§lu sorgulama, bilgi gÃ¶sterme ve WhatsApp ile mesaj gÃ¶nderme. Tam kapsamlÄ± borÃ§lu takip otomasyonu.",
    "icon": "ğŸ§ ",
    "nodes": [
        {
            "id": "trigger-1",
            "type": "MANUAL_TRIGGER",
            "label": "BaÅŸlat",
            "config": {},
            "position": {
                "x": 250,
                "y": 50
            }
        },
        {
            "id": "overlay-input-1",
            "type": "OVERLAY_INPUT",
            "label": "Sorgu Gir",
            "config": {
                "placeholder": "Ã–rn: 'Yavuz Obuz borcu ne?', 'Ali Veli'ye mesaj gÃ¶nder', '0532... kim?'",
                "variableName": "arama_sorgusu"
            },
            "position": {
                "x": 250,
                "y": 150
            }
        },
        {
            "id": "agent-1",
            "type": "AGENT_AI",
            "label": "BorÃ§lu Asistan",
            "config": {
                "model": "gemini-2.0-flash",
                "tools": [
                    "search_memory"
                ],
                "outputFormat": "json",
                "variableName": "sonuc",
                "prompt": "Sen bir borÃ§lu takip asistanÄ±sÄ±n. KullanÄ±cÄ±nÄ±n sorgusunu analiz et ve hafÄ±zadan arama yap.\n\nKullanÄ±cÄ± Sorgusu: {{arama_sorgusu}}\n\n## GÃ¶revlerin:\n\n### 1. Sorguyu Anla\nKullanÄ±cÄ± ÅŸunlarÄ± sorabilir:\n- Ä°sim ile arama: \"Yavuz Obuz\", \"Ali Veli'nin borcu\"\n- SÃ¶zleÅŸme no ile: \"sÃ¶zleÅŸme 12345\", \"no 67890\"\n- Telefon ile: \"0532...\", \"+90...\"\n- Mesaj gÃ¶nderme: \"Yavuz Obuz'a gÃ¶nder\", \"Ali'ye borÃ§ bilgisi gÃ¶nder\"\n- Genel sorgu: \"borcu en yÃ¼ksek kim?\", \"toplam kaÃ§ borÃ§lu var?\"\n\n### 2. HafÄ±zadan Ara\nsearch_memory tool'unu kullanarak ilgili kayÄ±tlarÄ± bul. Birden fazla sonuÃ§ gelebilir, hepsini deÄŸerlendir.\n\n### 3. Aksiyon Belirle\n- EÄŸer kullanÄ±cÄ± \"gÃ¶nder\", \"mesaj at\", \"whatsapp\", \"bildir\" gibi kelimeler kullandÄ±ysa â†’ action_type = \"mesaj_gÃ¶nder\"\n- EÄŸer sadece bilgi soruyorsa (\"borcu ne?\", \"kim bu?\", sÃ¶zleÅŸme arama) â†’ action_type = \"bilgi_gÃ¶ster\"\n- EÄŸer hiÃ§ sonuÃ§ bulamadÄ±ysan â†’ action_type = \"bulunamadÄ±\"\n\n### 4. Mobil BankacÄ±lÄ±k Åablonu (mesaj_gÃ¶nder durumunda)\nWhatsApp mesajÄ± ÅŸu formatta olmalÄ±:\n\nMOBÄ°L BANKACILIK\nMobil bankacÄ±lÄ±k ile Ã¶demek iÃ§in; hesaba giriÅŸ yapÄ±n Ã–demeler â†’ FATURA Ã–DEME â†’ Elektrik â†’ AyedaÅŸ DaÄŸÄ±tÄ±m veya Ä°stanbul Anadolu YakasÄ± Elektrik DaÄŸÄ±tÄ±m sekmesinden sÃ¶zleÅŸme numarasÄ± : [SÃ–ZLEÅME_NO] girin karÅŸÄ±nÄ±za borÃ§ bilgisi Ã§Ä±kacak [BORÃ‡_TUTARI] TL seÃ§ip Ã¶deyebilirsiniz.\n\n### 5. JSON Ã‡Ä±ktÄ± FormatÄ±\nHer zaman ÅŸu formatta JSON dÃ¶ndÃ¼r:\n{\n  \"action_type\": \"mesaj_gÃ¶nder\" | \"bilgi_gÃ¶ster\" | \"bulunamadÄ±\",\n  \"found\": true | false,\n  \"results_count\": 1,\n  \"name\": \"Ad Soyad\",\n  \"contract\": \"SÃ¶zleÅŸme No\",\n  \"debt\": \"BorÃ§ TutarÄ±\",\n  \"phone_number\": \"+90... veya boÅŸ string\",\n  \"muhatap\": \"Muhatap tanÄ±mÄ± (varsa)\",\n  \"durum\": \"Durum tanÄ±tÄ±cÄ±sÄ± (varsa)\",\n  \"whatsapp_message\": \"Mobil bankacÄ±lÄ±k ÅŸablonlu mesaj (sadece mesaj_gÃ¶nder ise)\",\n  \"summary\": \"KÄ±sa Ã¶zet bilgi (tÃ¼m durumlar iÃ§in)\",\n  \"all_results\": \"Birden fazla sonuÃ§ varsa tÃ¼m sonuÃ§larÄ±n listesi (opsiyonel)\"\n}\n\n## Ã–nemli Kurallar:\n- Telefon numarasÄ± varsa baÅŸÄ±nda +90 olmalÄ± (0532 â†’ +90532)\n- BorÃ§ tutarÄ±nÄ± TL formatÄ±nda yaz\n- Birden fazla sonuÃ§ varsa hepsini all_results alanÄ±nda listele\n- has_phone yerine phone_number boÅŸ/dolu kontrolÃ¼ yap\n- BulunamadÄ±ysa summary alanÄ±na anlamlÄ± bir mesaj yaz"
            },
            "position": {
                "x": 250,
                "y": 280
            }
        },
        {
            "id": "switch-1",
            "type": "SWITCH",
            "label": "Aksiyon YÃ¶nlendir",
            "config": {
                "variableName": "sonuc.action_type",
                "cases": [
                    {
                        "value": "mesaj_gÃ¶nder",
                        "portId": "case_1"
                    },
                    {
                        "value": "bilgi_gÃ¶ster",
                        "portId": "case_2"
                    }
                ],
                "defaultPortId": "case_3"
            },
            "position": {
                "x": 250,
                "y": 420
            }
        },
        {
            "id": "overlay-info-1",
            "type": "SHOW_OVERLAY",
            "label": "WhatsApp Ã–nizleme",
            "config": {
                "message": "ğŸ“¤ WhatsApp GÃ¶nderiliyor...\n\nğŸ‘¤ {{sonuc.name}}\nğŸ“„ SÃ¶zleÅŸme: {{sonuc.contract}}\nğŸ’° BorÃ§: {{sonuc.debt}} TL\nğŸ“± Tel: {{sonuc.phone_number}}"
            },
            "position": {
                "x": 50,
                "y": 540
            }
        },
        {
            "id": "whatsapp-1",
            "type": "WHATSAPP_SEND",
            "label": "WhatsApp GÃ¶nder",
            "config": {
                "phoneNumber": "{{sonuc.phone_number}}",
                "message": "{{sonuc.whatsapp_message}}"
            },
            "position": {
                "x": 50,
                "y": 660
            }
        },
        {
            "id": "overlay-success-1",
            "type": "SHOW_OVERLAY",
            "label": "GÃ¶nderim OnayÄ±",
            "config": {
                "message": "âœ… WhatsApp mesajÄ± gÃ¶nderildi!\n\nğŸ‘¤ {{sonuc.name}}\nğŸ“„ SÃ¶zleÅŸme: {{sonuc.contract}}\nğŸ’° BorÃ§: {{sonuc.debt}} TL"
            },
            "position": {
                "x": 50,
                "y": 780
            }
        },
        {
            "id": "overlay-detail-1",
            "type": "SHOW_OVERLAY",
            "label": "BorÃ§lu Detay",
            "config": {
                "message": "ğŸ“‹ BorÃ§lu Bilgileri:\n\nğŸ‘¤ Ad: {{sonuc.name}}\nğŸ“„ SÃ¶zleÅŸme: {{sonuc.contract}}\nğŸ’° BorÃ§: {{sonuc.debt}} TL\nğŸ“± Telefon: {{sonuc.phone_number}}\nğŸ“ Muhatap: {{sonuc.muhatap}}\nğŸ·ï¸ Durum: {{sonuc.durum}}\n\n{{sonuc.summary}}\n\n{{sonuc.all_results}}"
            },
            "position": {
                "x": 250,
                "y": 540
            }
        },
        {
            "id": "overlay-notfound-1",
            "type": "SHOW_OVERLAY",
            "label": "BulunamadÄ±",
            "config": {
                "message": "âŒ BorÃ§lu BulunamadÄ±\n\nArama: \"{{arama_sorgusu}}\"\n\n{{sonuc.summary}}\n\nğŸ’¡ Ä°pucu: Ad, sÃ¶zleÅŸme numarasÄ± veya telefon numarasÄ± ile tekrar deneyin."
            },
            "position": {
                "x": 450,
                "y": 540
            }
        },
        {
            "id": "menu-devam-1",
            "type": "SHOW_MENU",
            "label": "Devam Et?",
            "config": {
                "title": "BaÅŸka bir iÅŸlem yapmak ister misiniz?",
                "options": [
                    "ğŸ” Yeni Sorgu",
                    "âŒ Ã‡Ä±k"
                ],
                "variableName": "devam_secim"
            },
            "position": {
                "x": 250,
                "y": 900
            }
        },
        {
            "id": "if-devam-1",
            "type": "IF_ELSE",
            "label": "Devam mÄ±?",
            "config": {
                "conditions": [
                    {
                        "left": "{{devam_secim}}",
                        "operator": "==",
                        "right": "ğŸ” Yeni Sorgu"
                    }
                ],
                "logicOperator": "AND"
            },
            "position": {
                "x": 250,
                "y": 1020
            }
        }
    ],
    "edges": [
        {
            "id": "e-start",
            "sourceNodeId": "trigger-1",
            "targetNodeId": "overlay-input-1",
            "sourcePort": "default"
        },
        {
            "id": "e-input-agent",
            "sourceNodeId": "overlay-input-1",
            "targetNodeId": "agent-1",
            "sourcePort": "default"
        },
        {
            "id": "e-agent-switch",
            "sourceNodeId": "agent-1",
            "targetNodeId": "switch-1",
            "sourcePort": "default"
        },
        {
            "id": "e-switch-whatsapp",
            "sourceNodeId": "switch-1",
            "targetNodeId": "overlay-info-1",
            "sourcePort": "case_1"
        },
        {
            "id": "e-switch-detail",
            "sourceNodeId": "switch-1",
            "targetNodeId": "overlay-detail-1",
            "sourcePort": "case_2"
        },
        {
            "id": "e-switch-notfound",
            "sourceNodeId": "switch-1",
            "targetNodeId": "overlay-notfound-1",
            "sourcePort": "case_3"
        },
        {
            "id": "e-info-wa",
            "sourceNodeId": "overlay-info-1",
            "targetNodeId": "whatsapp-1",
            "sourcePort": "default"
        },
        {
            "id": "e-wa-success",
            "sourceNodeId": "whatsapp-1",
            "targetNodeId": "overlay-success-1",
            "sourcePort": "default"
        },
        {
            "id": "e-success-menu",
            "sourceNodeId": "overlay-success-1",
            "targetNodeId": "menu-devam-1",
            "sourcePort": "default"
        },
        {
            "id": "e-detail-menu",
            "sourceNodeId": "overlay-detail-1",
            "targetNodeId": "menu-devam-1",
            "sourcePort": "default"
        },
        {
            "id": "e-notfound-menu",
            "sourceNodeId": "overlay-notfound-1",
            "targetNodeId": "menu-devam-1",
            "sourcePort": "default"
        },
        {
            "id": "e-menu-check",
            "sourceNodeId": "menu-devam-1",
            "targetNodeId": "if-devam-1",
            "sourcePort": "default"
        },
        {
            "id": "e-devam-loop",
            "sourceNodeId": "if-devam-1",
            "targetNodeId": "overlay-input-1",
            "sourcePort": "true"
        }
    ]
}